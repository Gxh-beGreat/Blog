---
title: JavaScript语言精粹 - 对象篇
date: 2017-07-27 17:09:27
toc: true
categories:
  - 读书笔记
tags:
  - 读书笔记
  - JavaScript
---

---

> JavaScript 语言精粹 - 对象篇

---

_Javascript_ 的简单数据类型包括数字、字符串、布尔值、`null` 和 `undefined`，其他所有的值都是 _对象_。数字、字符串和布尔值是 ‘`貌似`’ 对象，因为它们拥有方法，但它们是不可变的。  
_Javascript_ 中的 _对象_ 是可变的键控集合( `keyed collections` ),在 _Javascript_ 中，数组、函数、正则表达式都是对象  
_对象_ 是 `属性` 的容器，其中每个属性都拥有名字`(key)`和值`(value)`，属性名可以是包括空字符串在内的任意字符串，属性值可以是除了 `undefined` 之外的任何值  
_Javascript_ 包含一种 _原型链_ 的特性，允许对象继承另一个对象的属性，正确使用能减少对象初始化时消耗的时间和内存

## 对象字面量(Object Literals)

在对象字面量中，如果属性名是一个合法的 `Javascript` 标识符且不是保留字，则并不强制要求用引号括住属性名

```javascript
const stooge = {
  'first-name': 'Amu',
  last_name: 'Amu'
};
```

## 检索(Retrieval)

尝试从 `undefined` 的成员属性中取值将会导致 `TypeError`,可通过 `&&` 运算符避免错误

```javascript
const flight = {};
flight.equipment; // undefined
flight.equipment.model; // throw 'TypeError'
flight.equipment && flight.equipment.model; // undefined
```

## 更新(Update)

对象里的值可以通过赋值语句更新，如果属性名(`key`)存在，则属性值会被替换，否则该属性会被扩充到对象中

```javascript
stooge['first-name'] = 'Gu';
stooge['middle-name'] = 'Amu';
```

## 引用(Reference)

对象通过引用来传递，它们永远不会被复制

```javascript
const x = stooge;
x.nickName = 'Amu';
// 因为 x 和 stooge 是指向同一个对象的引用，所以 stooge.nickName 为 Amu
stooge.nickName; // Amu
```

## 原型(Prototype)

每个对象都连接到一个原型对象，并且它可以从中继承属性。所有通过对象字面量创建的对象都连接到 `Object.prototype`,它是 `JavaScript` 中的标配对象。  
当你创建一个新对象时，你可以选择某个对象作为它的原型(`Object.create`)

```javascript
// 模拟Object.create
if (typeOf Object.create !== 'function') {
    Object.create = function (o) {
        const F = function () {}
        F.prototype = o
        return new F()
    }
}
```

原型链接在更新时不起作用，当我们对某个对象作出改变时，不会触及该对象的原型属性:

```javascript
const another_stooge = Object.create(stooge);
another_stooge.nickName = 'Ruby';
stooge.nickName; // 'Amu'
```

原型关系是一种动态的关系，如果我们添加一个新的属性到原型中，该属性会立即对所有基于该原型创建的对象可见

```javascript
stooge.prefession = 'coder';
another_stooge.prefession; // 'coder'
```

## 属性检测

`hasOwnProperty` 可以检查对象自身信息，如果对象拥有独有的属性，它将返回 `true`,`hasOwnProperty` 方法不会检查原型链

```javascript
another_stooge.hasOwnProperty('nickName'); // true
another_stooge.hasOwnProperty('first-name'); // false
```

## 枚举(Enumeration)

`for in` 语句可用来遍历一个对象中的所有属性名.该枚举过程将会列出所有的属性 —— 包括函数和你可能不关心的原型中的属性，所以有必要过滤掉你不想要的值，最为常用的过滤器是 `hasOwnProperty` 方法，以及使用 `typeOf` 来排除函数，还有一种创建 `纯对象` 的方法:

```javascript
const pureObj = Object.create(null);
pureObj instanceof Object; // false
```

`for in` 是无序的，如果需要正确顺序读取属性值，可以创建一个数组缓存属性名，然后按顺序遍历数组去读取对象属性值

## 删除(Delete)

`delete` 运算符用来删除对象的属性，如果对象包含该属性，则将其移除，它不会触及原型链中的任何对象。删除对象的属性可能会让来自原型中的属性透露出来:

```javascript
another_stooge.nickName; // 'Ruby'
delete another_stooge.nickName;
another_stooge.nickName; // 'Amu',来自 stooge.nickName
```
